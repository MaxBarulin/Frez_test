import math

# Удельное сопротивление резанию для различных материалов
kc_values = {
    "Углеродистая сталь": 1800,
    "Низколегированная сталь": 2200,
    "Высоколегированная сталь": 2500,
    "Чугун": 1500,
    "Нержавеющая сталь": 2800,
    "Алюминиевые сплавы": 700,
    "Латунь": 1000,
    "Медные сплавы": 1200,
    "Титан и его сплавы": 3000,
    "Никелевые сплавы": 3500,
    "Пластики": 500
}

# Основная функция
def main():
    while True:
        # Шаг 0: Ввод мощности шпинделя
        spindle_power_input = input("\nВведите доступную мощность шпинделя (кВт)\nили оставьте пустым для пропуска: ")
        spindle_power = float(spindle_power_input) if spindle_power_input else None

        # Шаг 1: Выбор материала обработки
        print("\nВыберите материал обработки из списка:")
        materials = list(kc_values.keys())
        for i, material in enumerate(materials, start=1):
            print(f"{i}. {material}")

        material_choice = int(input("Введите номер выбранного материала: ")) - 1
        material = materials[material_choice]
        kc = kc_values.get(material)

        # Шаг 2: Ввод параметров
        D = float(input("\nВведите диаметр фрезы D (мм): "))
        z = int(input("Введите количество зубьев фрезы z: "))
        t = float(input("Введите глубину резания t (мм): "))
        b = float(input("Введите ширину фрезерования b (мм): ")) # Добавлено
        L = float(input("Введите длину обработки L (мм): "))
        S = float(input("Введите подачу S (мм/мин): "))
        n = float(input("Введите частоту вращения шпинделя n (об/мин): "))

        print("")

        # Расчет скорости резания V
        V = (math.pi * D * n) / 1000 # м/мин

        # Расчет подачи на оборот F
        F = S / n # мм/об

        # Расчет подачи на зуб Fz
        Fz = F / z # мм/зуб

        # Расчет требуемой мощности резания P
        P = round((kc * t * b * S) / 60000000, 2) # кВт

        # Расчет времени обработки
        time = L / S # мин

        # Вывод результатов
        print("Заданные режимы резания")
        print(f"Диаметр фрезы D (мм): {D}")
        print(f"Количество зубьев фрезы z: {z}")
        print(f"Глубина резания t (мм): {t}")
        print(f"Ширина фрезерования b (мм): {b}")
        print(f"Длина обработки L (мм): {L}")
        print(f"Подача S (мм/мин): {S:.2f}")
        print(f"Скорость резания V (м/мин): {V:.2f}")
        print(f"Частота вращения шпинделя n (об/мин): {n:.2f}")
        print(f"Подача на оборот F (мм/об): {F:.4f}")
        print(f"Подача на зуб Fz (мм/зуб): {Fz:.4f}")
        print(f"Требуемая мощность резания P (кВт): {P:.2f}")
        print(f"Время обработки (мин): {time:.2f}")

        if spindle_power is None:
            print("\nРасчёт выполнен без учёта мощности шпинделя.")
        elif spindle_power < P:
            print(f"\nВНИМАНИЕ: Требуемая мощность резания ({P:.2f} кВт) превышает доступную мощность шпинделя ({spindle_power} кВт).\n")

            # Подбор оптимальных параметров
            S_opt = S
            P_opt = P

            while P_opt > spindle_power and S_opt > 0:
                S_opt -= 5 # Уменьшаем подачу на 5 мм/мин
                F_opt = S_opt / n
                P_opt = round((kc * t * b * S_opt) / 60000000, 2)

            if S_opt <= 0:
                print("Не удалось подобрать параметры, удовлетворяющие ограничению по мощности.")
                continue

            Fz_opt = F_opt / z
            time_opt = L / S_opt

            print("Рекомендуемые режимы резания")
            print(f"Диаметр фрезы D (мм): {D}")
            print(f"Количество зубьев фрезы z: {z}")
            print(f"Глубина резания t (мм): {t}")
            print(f"Ширина фрезерования b (мм): {b}")
            print(f"Длина обработки L (мм): {L}")
            print(f"Подача S (мм/мин): {S_opt:.2f}")
            print(f"Скорость резания V (м/мин): {V:.2f}")
            print(f"Частота вращения шпинделя n (об/мин): {n:.2f}")
            print(f"Подача на оборот F (мм/об): {F_opt:.4f}")
            print(f"Подача на зуб Fz (мм/зуб): {Fz_opt:.4f}")
            print(f"Требуемая мощность резания P (кВт): {P_opt:.2f}")
            print(f"Время обработки (мин): {time_opt:.2f}")
        else:
            print("\nТребуемая мощность резания не превышает доступную мощность шпинделя.")

# Запуск основной функции
main()
